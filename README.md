# fMRIPrepCleanup
fMRIPrep (https://fmriprep.org) is an optimised fMRI preprocessing pipeline that combines best practice tools from a number of sources. This includes the generation of a large number of files, including those prodcued as preprocessed output that will be used in subsequent analysis, outpit files that could be used by the researcher but in practice may never be used, and working directory files which are temporary in nature and are very unlikely to serve a practical use.

Severs use energy not only to process data, but also to store it. Additionally, filling servers with data increases the need to produce and purchase additional hardware to accomodate new projects. In both of these ways, the accumulation of unneeded 'junk' data contributes to the carbon footprint of research computing.

## Usage

As such, we provide here a script that can be used to automatically identify and delete junk files produced by fMRIPrep, used as follows:

```
fMRIPrepCleanup.py path/to/fMRIPrep/directory/
```

This script assumes that all files generated by fMRIPrep (including output files, log files, and working directory files) are contained somewhere within this directory. Beyond this, the script does not assume or rely on any particular file structure or naming convention. Depnding on how oyu have structured your output folders, this could be run at the level of one participant or a full sample. Instead, it simply deletes all files that do not contain one of the following strings (rationale provided for each):

- '*preproc*': Targets any preprocessed functional and anatomical files generated by fMRIPrep, in each output space generated.
- '*brain_mask*': Targets the brain 'mask' generated by fMRIPrep that accompanies each preprocessed functional and anatomical output file.
- '*confounds*': Targets the confounds TSV file generated for each BOLD run, as this data is often used in subsequent analysis steps.
- '*html*': Targets the final output report generated by fMRIPrep for each subject, as well as some of the 'figures' used to populate it.
- '*svg*': Targets the remaining 'figures' used to populate the output report for each subject.
- '*emissions*': Targets the estimated carbon emissions output file generated by CodeCarbon (if toggled on when running fMRIPrep using the 'track-cabron' flag, which we recommand for monitoring purposes).
